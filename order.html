<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="images/icons/shawarma.ico" type="image/x-icon">
    <link rel="stylesheet" href="CSS/style.css">
    <link rel="stylesheet" href="CSS/fonts.css">
    <link rel="stylesheet" href="CSS/order.css">
    <link rel="stylesheet" href="CSS/basket.css">
    <link rel="stylesheet" href="CSS/mainMenu.css">
    <title>Шаурмания</title>
</head>

<body>
  <nav class="menu">
      <a href="index.html">Главная</a>
      <a href="about.html">О нас</a>
      <a href="newThings.html">Горячие новинки</a>
      <a href="menu.html">Меню</a>
  </nav>
  <button class="burgerMenu">
      <img src="images/header_page/burgerMenuButton.png">
  </button>
  <div class="temno"></div>
  <div class="basket">
      <button onclick="window.location.href = 'basket.html'" class="basket-btn">
          <img class="basket-image" src="images/icons/basket.png" alt="Корзина">
      </button>
  </div>
  <div id="main">
      <div id="purchase-list">
          <div class="purchase-header">
              <div id="basket-counter">Товаров в заказе: 0</div>
              </div> </div> </div>
    <div class = "ordering">
        <h5 class="order" ALIGN="center">Оформить заказ</h5>
        <p class="cardText" id="number">Номер карты</p>
        <input type="text" data-format=" ****-****-****-****" data-mask=" ____.____.____.____" class="bankCard" id="cardNumber" placeholder="Номер карты">
        
        <p class="cardText" id="date">Срок действия</p>
        <input type="text" data-format=" **/**" data-mask=" __/__" class="bankCard" id="cardDate" placeholder="Срок действия">
        
        <p class="cardText" id="cvv">cvv</p>
        <input type="text" data-format=" ***" data-mask=" ___" class="bankCard" id="cardCvv" placeholder="cvv">
    </div>
    </div>
    <script>
        function doFormat(value, pattern, mask)
        {
            // удаляем все нечисловые значения из значения
            const strippedValue = value.replace(/[^0-9]/g, "");

            // преобразуем строку-значение в массив символов
            const chars = strippedValue.split('');


            let count = 0;
            let formatted = '';

            // форматируем строку
            for (let i = 0; i < pattern.length; i++)
            {
                const char = pattern[i];
                if (chars[count])
                {
                    if (/\*/.test(char)) {
                        formatted += chars[count];
                        count++;
                    } else {
                        formatted += char;
                    }
                }
                else if (mask)
                {
                    const splittedMask = mask.split('');

                    if (splittedMask[i])
                    {
                        formatted += splittedMask[i];
                    }
                }
            }


            return formatted;
        }


        // проходимся по каждому элементу назначая на них обработчики
        // нажатия клавиш
        document.querySelectorAll('[data-mask]').forEach(function (e) {


            function format(elem) {
                const val = doFormat(elem.value, elem.getAttribute('data-format'));
                elem.value = doFormat(elem.value, elem.getAttribute('data-format'), elem.getAttribute('data-mask'));

                if (elem.createTextRange) {
                    var range = elem.createTextRange();
                    range.move('character', val.length);
                    range.select();
                } else if (elem.selectionStart) {
                    elem.focus();
                    elem.setSelectionRange(val.length, val.length);
                }
            }

            e.addEventListener('keyup', function () {
                format(e);
            });

            e.addEventListener('keydown', function () {
                format(e);
            });

            format(e)
        });
    </script>
  <script type="module" src="JS/order.js"></script>
  <script src="JS/burgerMenu.js"></script>

</body>